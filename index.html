<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gym para Piquis - Entrena Inteligente</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sf-symbols@2.0.0/sf-symbols.css">
</head>
<body>
    <!-- Navegaci√≥n Principal -->
    <nav class="main-nav">
        <div class="nav-container">
            <h1 class="nav-title">Gym para Piquis</h1>
            <div class="nav-actions">
                <button class="backup-indicator" id="backupIndicator" title="Estado del backup">
                    <span class="backup-icon sf-symbol">icloud.fill</span>
                    <span class="backup-text">Backup OK</span>
                </button>
                <button class="theme-toggle" id="themeToggle" aria-label="Cambiar tema"><span class="sf-symbol">moon.fill</span></button>
            </div>
        </div>
    </nav>

    <!-- Container Principal -->
    <div class="app-container">
        
        <!-- Dashboard Principal -->
        <section id="dashboard" class="view active">
            <div class="container">
                <h2>Dashboard</h2>
                
                <!-- Estad√≠sticas R√°pidas -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalWorkouts">0</div>
                        <div class="stat-label">Entrenamientos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalRoutines">0</div>
                        <div class="stat-label">Rutinas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="lastWorkout">-</div>
                        <div class="stat-label">√öltimo</div>
                    </div>
                    <div class="stat-card backup-card">
                        <div class="stat-value" id="lastBackup">-</div>
                        <div class="stat-label">√öltimo Backup</div>
                    </div>
                </div>

                <!-- Recordatorio de Backup -->
                <div id="backupReminder" class="backup-reminder hidden">
                    <div class="reminder-icon">‚ö†Ô∏è</div>
                    <div class="reminder-content">
                        <strong>Recordatorio de Backup</strong>
                        <p>Han pasado m√°s de 7 d√≠as desde tu √∫ltimo backup manual. ¬°Protege tus datos!</p>
                    </div>
                    <button class="btn btn--primary btn--sm" id="quickBackupBtn">Backup Ahora</button>
                </div>

                <!-- Acci√≥n Principal -->
                <div class="main-action">
                    <button class="btn btn--primary btn--lg btn--full-width" id="startWorkoutBtn">
                        üèãÔ∏è Iniciar Entrenamiento
                    </button>
                </div>

                <!-- Entrenamientos Recientes -->
                <div class="recent-workouts">
                    <h3>Entrenamientos Recientes</h3>
                    <div id="recentWorkoutsList" class="workout-list"></div>
                </div>
            </div>
        </section>

        <!-- Biblioteca de Ejercicios -->
        <section id="exerciseLibrary" class="view">
            <div class="container">
                <div class="section-header">
                    <h2>Biblioteca de Ejercicios</h2>
                    <button class="btn btn--primary" id="createCustomExerciseBtn">+ Ejercicio Personalizado</button>
                </div>
                
                <!-- Filtro por Grupo Muscular -->
                <div class="muscle-filter">
                    <button class="muscle-btn active" data-muscle="all">Todos</button>
                    <button class="muscle-btn" data-muscle="Pecho">Pecho</button>
                    <button class="muscle-btn" data-muscle="Espalda">Espalda</button>
                    <button class="muscle-btn" data-muscle="Piernas">Piernas</button>
                    <button class="muscle-btn" data-muscle="Hombros">Hombros</button>
                    <button class="muscle-btn" data-muscle="Brazos">Brazos</button>
                </div>

                <div id="exerciseLibraryList" class="exercise-library-list"></div>
            </div>
        </section>

        <!-- Rutinas -->
        <section id="routines" class="view">
            <div class="container">
                <div class="section-header">
                    <h2>Mis Rutinas</h2>
                    <div class="routines-actions">
                        <button class="btn btn--secondary" id="createFolderBtn">+ Carpeta</button>
                        <button class="btn btn--primary" id="createRoutineBtn">+ Nueva Rutina</button>
                    </div>
                </div>

                <!-- Breadcrumbs para carpetas anidadas -->
                <div id="folderBreadcrumbs" class="breadcrumbs hidden">
                    <span class="breadcrumb-item" data-folder="">üè† Inicio</span>
                </div>

                <div id="routinesList" class="routines-list"></div>
            </div>
        </section>

        <!-- Crear/Editar Rutina -->
        <section id="routineEditor" class="view">
            <div class="container">
                <div class="section-header">
                    <h2 id="routineEditorTitle">Nueva Rutina</h2>
                    <button class="btn btn--secondary" id="cancelRoutineBtn">Cancelar</button>
                </div>

                <form id="routineForm" class="routine-form">
                    <div class="form-group">
                        <label class="form-label" for="routineName">Nombre de la Rutina</label>
                        <input type="text" class="form-control" id="routineName" placeholder="Ej: Push A - Pecho y Hombros" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="routineFolder">Carpeta</label>
                        <select class="form-control" id="routineFolder">
                            <option value="">Sin carpeta</option>
                        </select>
                    </div>

                    <div class="exercises-section">
                        <h3>Ejercicios</h3>
                        <div id="exercisesList" class="exercises-list"></div>
                        <button type="button" class="btn btn--outline btn--full-width" id="addExerciseBtn">+ Agregar desde Biblioteca</button>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn--primary btn--full-width">Guardar Rutina</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Seleccionar Rutina para Entrenar -->
        <section id="selectRoutine" class="view">
            <div class="container">
                <div class="section-header">
                    <h2>Seleccionar Rutina</h2>
                    <button class="btn btn--secondary" id="backToDashboard">Cancelar</button>
                </div>
                <div id="selectRoutineList" class="select-routine-list"></div>
            </div>
        </section>

        <!-- Vista de Entrenamiento (Lista de Ejercicios) -->
        <section id="workoutOverview" class="view">
            <div class="container">
                <div class="workout-header">
                    <h2 id="workoutOverviewTitle">Entrenamiento</h2>
                    <button class="btn btn--secondary" id="cancelWorkoutBtn">Cancelar</button>
                </div>

                <div id="workoutExercisesList" class="workout-exercises-list"></div>

                <div class="workout-actions">
                    <button class="btn btn--primary btn--full-width" id="finishWorkoutFromOverviewBtn">Finalizar Entrenamiento</button>
                </div>
            </div>
        </section>

        <!-- Registro de Serie -->
        <section id="exerciseDetail" class="view">
            <div class="container">
                <div class="section-header">
                    <h2 id="exerciseDetailTitle">Registrar Serie</h2>
                    <button class="btn btn--secondary" id="backToWorkoutOverviewBtn">Volver</button>
                </div>

                <div id="exerciseDetailContent" class="exercise-detail-content"></div>
            </div>
        </section>

        <!-- Historial -->
        <section id="history" class="view">
            <div class="container">
                <h2>Historial</h2>
                <div id="historyList" class="history-list"></div>
            </div>
        </section>

        <!-- Editar Entrenamiento -->
        <section id="editWorkout" class="view">
            <div class="container">
                <div class="section-header">
                    <h2>Editar Entrenamiento</h2>
                    <button class="btn btn--secondary" id="cancelEditWorkoutBtn">Cancelar</button>
                </div>
                
                <form id="editWorkoutForm">
                    <div class="form-group">
                        <label class="form-label" for="editWorkoutDate">Fecha del Entrenamiento</label>
                        <input type="date" class="form-control" id="editWorkoutDate" required>
                    </div>

                    <div id="editWorkoutExercises" class="edit-workout-exercises"></div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn--primary btn--full-width">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Progreso -->
        <section id="progress" class="view">
            <div class="container">
                <h2>Progreso</h2>
                <div id="progressContent" class="progress-content">
                    <p>Aqu√≠ ver√°s tu progreso por ejercicio cuando tengas m√°s datos.</p>
                </div>
            </div>
        </section>

        <!-- Configuraci√≥n de Backup -->
        <section id="backupConfig" class="view">
            <div class="container">
                <div class="section-header">
                    <h2>Configuraci√≥n de Backup</h2>
                    <button class="btn btn--secondary" id="backFromBackupConfig">Volver</button>
                </div>

                <div class="backup-config-content">
                    <div class="backup-status-card">
                        <h3>Estado del Backup</h3>
                        <div class="backup-info">
                            <div class="backup-stat">
                                <span class="backup-label">√öltimo backup autom√°tico:</span>
                                <span id="lastAutoBackup">Nunca</span>
                            </div>
                            <div class="backup-stat">
                                <span class="backup-label">√öltimo backup manual:</span>
                                <span id="lastManualBackup">Nunca</span>
                            </div>
                            <div class="backup-stat">
                                <span class="backup-label">Backups autom√°ticos almacenados:</span>
                                <span id="storedBackups">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="backup-actions-grid">
                        <button class="btn btn--primary backup-action-btn" id="createManualBackup">
                            <span class="backup-action-icon">üíæ</span>
                            <span class="backup-action-title">Backup Manual</span>
                            <span class="backup-action-desc">Crear backup ahora</span>
                        </button>

                        <button class="btn btn--secondary backup-action-btn" id="exportDataBtn">
                            <span class="backup-action-icon">üì§</span>
                            <span class="backup-action-title">Exportar Datos</span>
                            <span class="backup-action-desc">Descargar archivo JSON</span>
                        </button>

                        <button class="btn btn--outline backup-action-btn" id="importDataBtn">
                            <span class="backup-action-icon">üì•</span>
                            <span class="backup-action-title">Importar Datos</span>
                            <span class="backup-action-desc">Cargar desde archivo</span>
                        </button>

                        <button class="btn btn--secondary backup-action-btn" id="exportRoutineBtn">
                            <span class="backup-action-icon">üìã</span>
                            <span class="backup-action-title">Exportar Rutina</span>
                            <span class="backup-action-desc">Compartir rutina individual</span>
                        </button>
                    </div>

                    <div class="backup-settings">
                        <h3>Configuraci√≥n</h3>
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="autoBackupEnabled" checked> 
                                Backup autom√°tico activado
                            </label>
                            <p class="form-help">Crea backups autom√°ticos cada d√≠a y guarda tu progreso cada 30 segundos</p>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="backupRemindersEnabled" checked> 
                                Recordatorios de backup
                            </label>
                            <p class="form-help">Te recordaremos hacer backup manual cada 7 d√≠as</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- Navegaci√≥n Inferior -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-view="dashboard">
            <span class="nav-icon sf-symbol">house.fill</span>
            <span class="nav-label">Inicio</span>
        </button>
        <button class="nav-item" data-view="exerciseLibrary">
            <span class="nav-icon sf-symbol">book.fill</span>
            <span class="nav-label">Biblioteca</span>
        </button>
        <button class="nav-item" data-view="routines">
            <span class="nav-icon sf-symbol">list.bullet.clipboard.fill</span>
            <span class="nav-label">Rutinas</span>
        </button>
        <button class="nav-item" data-view="history">
            <span class="nav-icon sf-symbol">chart.bar.fill</span>
            <span class="nav-label">Historial</span>
        </button>
        <button class="nav-item" data-view="backupConfig">
            <span class="nav-icon sf-symbol">arrow.clockwise.icloud.fill</span>
            <span class="nav-label">Backup</span>
        </button>
    </nav>

    <!-- Navegaci√≥n de Entrenamiento (se muestra solo durante entrenamientos) -->
    <nav id="workoutBottomNav" class="workout-bottom-nav hidden">
        <button class="workout-nav-btn" id="prevExerciseBtn">
            <span class="workout-nav-icon sf-symbol">chevron.backward</span>
            <span class="workout-nav-label">Anterior</span>
        </button>
        <button class="workout-nav-btn" id="workoutOverviewBtn">
            <span class="workout-nav-icon sf-symbol">list.bullet.clipboard</span>
            <span class="workout-nav-label">Lista Completa</span>
        </button>
        <button class="workout-nav-btn" id="nextExerciseBtn">
            <span class="workout-nav-icon">‚û°Ô∏è</span>
            <span class="workout-nav-label">Siguiente</span>
        </button>
    </nav>

    <!-- Modal para crear carpeta -->
    <div id="folderModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="folderModalTitle">Nueva Carpeta</h3>
                <button class="modal-close" id="closeFolderModal">&times;</button>
            </div>
            <form id="folderForm">
                <div class="form-group">
                    <label class="form-label" for="folderName">Nombre de la Carpeta</label>
                    <input type="text" class="form-control" id="folderName" placeholder="Ej: Preparaci√≥n Competencia" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="parentFolder">Carpeta Padre</label>
                    <select class="form-control" id="parentFolder">
                        <option value="">Carpeta ra√≠z</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" id="cancelFolderBtn">Cancelar</button>
                    <button type="submit" class="btn btn--primary">Crear</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para agregar ejercicio desde biblioteca (SIMPLIFICADO) -->
    <div id="exerciseModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Agregar a Rutina</h3>
                <button class="modal-close" id="closeExerciseModal">&times;</button>
            </div>
            <form id="exerciseForm">
                <div class="form-group">
                    <label class="form-label" for="selectedExerciseName">Ejercicio Seleccionado</label>
                    <input type="text" class="form-control" id="selectedExerciseName" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label" for="targetRoutine">Rutina Destino</label>
                    <select class="form-control" id="targetRoutine" required>
                        <option value="">Seleccionar rutina...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="exerciseEquipment">Equipamiento</label>
                    <select class="form-control" id="exerciseEquipment" required>
                        <option value="">Seleccionar equipamiento...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="exerciseSets">Series</label>
                    <input type="number" class="form-control" id="exerciseSets" min="1" max="10" value="3" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="exerciseReps">Repeticiones</label>
                    <input type="number" class="form-control" id="exerciseReps" min="1" max="50" value="10" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="exerciseWeight">Peso Objetivo (kg)</label>
                    <input type="number" class="form-control" id="exerciseWeight" min="0" step="0.25" value="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="exerciseNotes">Observaciones</label>
                    <textarea class="form-control" id="exerciseNotes" rows="2" placeholder="Notas sobre t√©cnica, forma, etc."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" id="cancelExerciseBtn">Cancelar</button>
                    <button type="submit" class="btn btn--primary" id="addToRoutineBtn">A√±adir a Rutina</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para editar ejercicio en rutina -->
    <div id="editExerciseModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Ejercicio</h3>
                <button class="modal-close" id="closeEditExerciseModal">&times;</button>
            </div>
            <form id="editExerciseForm">
                <div class="form-group">
                    <label class="form-label" for="editExerciseName">Ejercicio</label>
                    <input type="text" class="form-control" id="editExerciseName" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editExerciseEquipment">Equipamiento</label>
                    <select class="form-control" id="editExerciseEquipment" required>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editExerciseSets">Series</label>
                    <input type="number" class="form-control" id="editExerciseSets" min="1" max="10" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editExerciseReps">Repeticiones</label>
                    <input type="number" class="form-control" id="editExerciseReps" min="1" max="50" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editExerciseWeight">Peso Objetivo (kg)</label>
                    <input type="number" class="form-control" id="editExerciseWeight" min="0" step="0.25" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editExerciseNotes">Observaciones</label>
                    <textarea class="form-control" id="editExerciseNotes" rows="2"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" id="cancelEditExerciseBtn">Cancelar</button>
                    <button type="submit" class="btn btn--primary">Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para crear ejercicio personalizado -->
    <div id="customExerciseModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ejercicio Personalizado</h3>
                <button class="modal-close" id="closeCustomExerciseModal">&times;</button>
            </div>
            <form id="customExerciseForm">
                <div class="form-group">
                    <label class="form-label" for="customExerciseName">Nombre del Ejercicio</label>
                    <input type="text" class="form-control" id="customExerciseName" placeholder="Ej: Press Arnold" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="customExerciseMuscle">Grupo Muscular</label>
                    <select class="form-control" id="customExerciseMuscle" required>
                        <option value="">Seleccionar grupo...</option>
                        <option value="Pecho">Pecho</option>
                        <option value="Espalda">Espalda</option>
                        <option value="Piernas">Piernas</option>
                        <option value="Hombros">Hombros</option>
                        <option value="Brazos">Brazos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="customExerciseDesc">Descripci√≥n</label>
                    <input type="text" class="form-control" id="customExerciseDesc" placeholder="Breve descripci√≥n del ejercicio">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" id="cancelCustomExerciseBtn">Cancelar</button>
                    <button type="submit" class="btn btn--primary">Crear</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de resumen de entrenamiento -->
    <div id="workoutSummaryModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>¬°Entrenamiento Completado!</h3>
            </div>
            <div id="workoutSummaryContent" class="workout-summary">
                <!-- Se renderizar√° din√°micamente -->
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn--primary btn--full-width" id="closeSummaryBtn">Continuar</button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n -->
    <div id="confirmModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmTitle">Confirmar</h3>
            </div>
            <p id="confirmMessage">¬øEst√°s seguro?</p>
            <div class="form-actions">
                <button type="button" class="btn btn--secondary" id="confirmCancel">Cancelar</button>
                <button type="button" class="btn btn--primary" id="confirmOk">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Modal para exportar rutina individual -->
    <div id="exportRoutineModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Exportar Rutina</h3>
                <button class="modal-close" id="closeExportRoutineModal">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label" for="routineToExport">Seleccionar Rutina</label>
                <select class="form-control" id="routineToExport" required>
                    <option value="">Seleccionar rutina para exportar...</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn--secondary" id="cancelExportRoutine">Cancelar</button>
                <button type="button" class="btn btn--primary" id="confirmExportRoutine">Exportar</button>
            </div>
        </div>
    </div>

    <!-- Input de archivo oculto para importar -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;">

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <p>¬© 2024 Gym para Piquis. Todos los derechos reservados.</p>
            <p class="version">Versi√≥n 1.0</p>
        </div>
    </footer>

    <script src="app.js"></script>
</body>
</html>
